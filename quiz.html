<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Révision C - Quiz</title>
    <meta name="description" content="Quiz C chronométré avec score, pénalité temps et historique d'erreurs." />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body data-page="quiz">
    <header class="site-header" role="banner">
      <div class="nav-wrap">
        <a class="brand" href="index.html">C Active Recall</a>
        <button id="navToggle" class="nav-toggle" type="button" aria-label="Menu" aria-controls="navMenu" aria-expanded="false">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <nav aria-label="Navigation principale">
          <ul id="navMenu" class="nav-menu">
            <li><a class="nav-link" href="index.html">Accueil</a></li>
            <li><a class="nav-link" href="flashcards.html">Flashcards</a></li>
            <li><a class="nav-link" href="quiz.html" aria-current="page">Quiz</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main>
      <section class="panel quiz-setup-panel" id="quizSetupPanel">
        <p class="quiz-eyebrow">Sessions de quiz</p>
        <h1 class="panel-title quiz-main-title">Quiz de révision C</h1>
        <p class="panel-subtitle">Choisissez un thème puis lancez 10 ou 20 questions (40 en mode mix).</p>

        <div class="quiz-controls">
          <p class="quiz-control-label">Thèmes</p>
          <div id="quizThemeSelector" class="theme-selector" role="group" aria-label="Choix du thème">
            <button type="button" class="theme-btn is-active" data-theme="random">
              <span class="theme-dot dot-random"></span>
              <span>Mix des thèmes</span>
            </button>
            <button type="button" class="theme-btn" data-theme="patterns">
              <span class="theme-dot dot-patterns"></span>
              <span>Patterns</span>
            </button>
            <button type="button" class="theme-btn" data-theme="pieges">
              <span class="theme-dot dot-pieges"></span>
              <span>Pièges</span>
            </button>
            <button type="button" class="theme-btn" data-theme="reflexes_memoire">
              <span class="theme-dot dot-reflexes"></span>
              <span>Réflexes mémoire</span>
            </button>
            <button type="button" class="theme-btn" data-theme="pointeurs_malloc">
              <span class="theme-dot dot-pointeurs"></span>
              <span>Pointeurs & malloc</span>
            </button>
            <button type="button" class="theme-btn" data-theme="listes_chainees">
              <span class="theme-dot dot-listes"></span>
              <span>Listes chaînées</span>
            </button>
            <button type="button" class="theme-btn" data-theme="conditions_limites">
              <span class="theme-dot dot-conditions"></span>
              <span>Conditions limites</span>
            </button>
            <button type="button" class="theme-btn" data-theme="regles_implicites">
              <span class="theme-dot dot-regles"></span>
              <span>Règles implicites</span>
            </button>
          </div>

          <p class="quiz-control-label">Mode fiches de révision</p>
          <button id="revisionModeBtn" class="pill-toggle" type="button" aria-pressed="false">
            Mode fiches de révision
          </button>

          <p class="quiz-control-label">Nombre de questions</p>
          <div id="sessionSizeSelector" class="session-selector" role="group" aria-label="Choix du nombre de questions">
            <button type="button" class="session-btn" data-size="10">10</button>
            <button type="button" class="session-btn is-active" data-size="20">20</button>
            <button type="button" class="session-btn" data-size="40">40</button>
          </div>

          <div class="btn-row quiz-start-row">
            <button id="startQuizBtn" class="btn btn-primary cta-start" type="button">Lancer une session</button>
            <a class="btn btn-secondary" href="flashcards.html">Aller aux flashcards</a>
          </div>

          <p id="quizDataStatus" class="quiz-status">0 questions prêtes.</p>
        </div>

        <div class="control-grid quiz-advanced-grid mt-16">
          <div class="field">
            <label for="timerPerQuestionSelect">Timer par question</label>
            <select id="timerPerQuestionSelect">
              <option value="10">10s</option>
              <option value="15">15s</option>
              <option value="20" selected>20s</option>
              <option value="30">30s</option>
            </select>
          </div>
          <div class="field">
            <label for="timePenaltySelect">Pénalité temps erreur</label>
            <select id="timePenaltySelect">
              <option value="2">2s</option>
              <option value="3" selected>3s</option>
              <option value="5">5s</option>
            </select>
          </div>
        </div>
      </section>

      <article class="panel quiz-history-panel">
        <div class="quiz-history-head">
          <div>
            <p class="quiz-eyebrow">Historique</p>
            <h2 class="panel-title">Vos dernières notes</h2>
          </div>
          <span id="quizHistoryCount" class="history-count">0</span>
          <button id="clearQuizHistoryBtn" class="btn btn-secondary btn-square" type="button" aria-label="Vider l'historique">
            Vider
          </button>
        </div>
        <div class="mt-16">
          <ul id="quizHistoryList" class="list"></ul>
        </div>
      </article>

      <section id="quizSessionPanel" class="panel hidden" aria-live="polite">
        <div class="quiz-top">
          <article class="quiz-card">
            <p class="stat-label">Progression</p>
            <p id="quizProgress" class="stat-value">0 / 0</p>
          </article>
          <article class="quiz-card">
            <p class="stat-label">Score</p>
            <p id="quizScore" class="stat-value">0</p>
          </article>
          <article class="quiz-card">
            <p class="stat-label">Pénalité</p>
            <p id="quizPenalty" class="stat-value">0s</p>
          </article>
          <article class="quiz-card">
            <p class="stat-label">Timer</p>
            <p id="quizTimer" class="stat-value timer-value">00:00</p>
          </article>
        </div>

        <article class="quiz-card">
          <h2 id="quizQuestion" class="question-title">Question</h2>
          <div id="quizChoices" class="choices" role="list"></div>
          <p id="quizFeedback" class="feedback" aria-live="polite"></p>
          <div class="btn-row">
            <button id="nextQuestionBtn" class="btn btn-primary hidden" type="button">Question suivante</button>
          </div>
        </article>
      </section>

      <section id="quizFinalPanel" class="panel hidden" aria-live="polite">
        <h2 class="panel-title">Récapitulatif de session</h2>
        <div class="final-grid">
          <p id="finalThemeText" class="panel-subtitle"></p>
          <p id="finalScoreText" class="panel-subtitle"></p>
          <p id="finalPenaltyText" class="panel-subtitle"></p>
        </div>

        <article class="panel mt-16">
          <h3 class="panel-title">Vue globale</h3>
          <p class="panel-subtitle">Chaque case représente une question. Clique pour afficher le détail.</p>
          <div id="quizResultGrid" class="result-grid" role="list"></div>
          <div id="quizResultDetail" class="result-detail mt-16"></div>
        </article>

        <article class="panel mt-16">
          <h3 class="panel-title">Erreurs de la session</h3>
          <ul id="quizErrorsList" class="list"></ul>
        </article>

        <div class="btn-row">
          <button id="restartQuizBtn" class="btn btn-primary" type="button">Relancer un quiz</button>
          <button id="exportErrorsBtn" class="btn btn-secondary" type="button">Exporter erreurs JSON</button>
          <a class="btn btn-secondary" href="index.html">Retour accueil</a>
        </div>
      </section>
    </main>

    <script type="module" src="quiz.js"></script>
  </body>
</html>
